import{m as R,V as I,a as E,b}from"./VOverlay.0c8ad404.js";import{f as L}from"./forwardRefs.890e72a9.js";import{p as S,ao as O,z as K,G as U,B,l as F,e as V,f as z,i as H,s as N,k as $,u as j,q,F as G,a as k,m as A,aC as J,aD as Q,aA as p,O as W,ap as g}from"./index.f751ad68.js";import{u as X}from"./scopeId.c745a8cf.js";import{u as Y,i as Z}from"./index.5f7d1d4c.js";const _=S({id:String,submenu:Boolean,...O(R({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:I}}),["absolute"])},"VMenu"),le=K()({name:"VMenu",props:_(),emits:{"update:modelValue":t=>!0},setup(t,P){let{slots:c}=P;const s=U(t,"modelValue"),{scopeId:h}=X(),{isRtl:f}=B(),d=F(),m=V(()=>t.id||`v-menu-${d}`),l=z(),a=H(E,null),v=N(new Set);$(E,{register(){v.value.add(d)},unregister(){v.value.delete(d)},closeParents(e){setTimeout(()=>{var n;!v.value.size&&!t.persistent&&(e==null||((n=l.value)==null?void 0:n.contentEl)&&!J(e,l.value.contentEl))&&(s.value=!1,a==null||a.closeParents())},40)}}),j(()=>a==null?void 0:a.unregister()),q(()=>s.value=!1);async function y(e){var u,r,i;const n=e.relatedTarget,o=e.target;await W(),s.value&&n!==o&&((u=l.value)==null?void 0:u.contentEl)&&((r=l.value)==null?void 0:r.globalTop)&&![document,l.value.contentEl].includes(o)&&!l.value.contentEl.contains(o)&&((i=p(l.value.contentEl)[0])==null||i.focus())}G(s,e=>{e?(a==null||a.register(),document.addEventListener("focusin",y,{once:!0})):(a==null||a.unregister(),document.removeEventListener("focusin",y))});function C(e){a==null||a.closeParents(e)}function D(e){var n,o,u,r,i;if(!t.disabled)if(e.key==="Tab"||e.key==="Enter"&&!t.closeOnContentClick){if(e.key==="Enter"&&(e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLInputElement&&!!e.target.closest("form")))return;e.key==="Enter"&&e.preventDefault(),Q(p((n=l.value)==null?void 0:n.contentEl,!1),e.shiftKey?"prev":"next",M=>M.tabIndex>=0)||(s.value=!1,(u=(o=l.value)==null?void 0:o.activatorEl)==null||u.focus())}else t.submenu&&e.key===(f.value?"ArrowRight":"ArrowLeft")&&(s.value=!1,(i=(r=l.value)==null?void 0:r.activatorEl)==null||i.focus())}function w(e){var o;if(t.disabled)return;const n=(o=l.value)==null?void 0:o.contentEl;n&&s.value?e.key==="ArrowDown"?(e.preventDefault(),e.stopImmediatePropagation(),g(n,"next")):e.key==="ArrowUp"?(e.preventDefault(),e.stopImmediatePropagation(),g(n,"prev")):t.submenu&&(e.key===(f.value?"ArrowRight":"ArrowLeft")?s.value=!1:e.key===(f.value?"ArrowLeft":"ArrowRight")&&(e.preventDefault(),g(n,"first"))):(t.submenu?e.key===(f.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(e.key))&&(s.value=!0,e.preventDefault(),setTimeout(()=>setTimeout(()=>w(e))))}const x=V(()=>A({"aria-haspopup":"menu","aria-expanded":String(s.value),"aria-owns":m.value,onKeydown:w},t.activatorProps));return Y(()=>{var n;const e=b.filterProps(t);return k(b,A({ref:l,id:m.value,class:["v-menu",t.class],style:t.style},e,{modelValue:s.value,"onUpdate:modelValue":o=>s.value=o,absolute:!0,activatorProps:x.value,location:(n=t.location)!=null?n:t.submenu?"end":"bottom","onClick:outside":C,onKeydown:D},h),{activator:c.activator,default:function(){for(var o=arguments.length,u=new Array(o),r=0;r<o;r++)u[r]=arguments[r];return k(Z,{root:"VMenu"},{default:()=>{var i;return[(i=c.default)==null?void 0:i.call(c,...u)]}})}})}),L({id:m,\u03A8openChildren:v},l)}});export{le as V};
